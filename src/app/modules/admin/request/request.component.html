<div class="content content--smaller">

    <div class="d-flex d-flex_horizontal--space-between d-flex_vertical--center margin--2x">
        <h2>All Requests</h2>
        <div class="d-flex">
          <app-input fieldClass="no-margin--top" type="date"  id="fromDate" [control]="fromDate" class="form-control"  >
          </app-input>
          <app-input fieldClass="no-margin--top" type="date"  id="toDate" [control]="toDate" class="form-control"  >
          </app-input>
            <!-- <app-dropdown [fieldClass]="'no-margin--all'" [class]="'no-margin--all'" [current]="'Today'">
                <option value="Today">Today</option>
            </app-dropdown> -->
        </div>
    </div>
    <app-tabs>
        <app-tab>
            <app-tab-header>Loans</app-tab-header>
            <app-tab-body>
                <div class="padding--2x"><app-drag-and-drop (onClick)="selectLoan($event)" [items$]="loans$"></app-drag-and-drop></div>
            </app-tab-body>
          </app-tab>
        <app-tab>
          <app-tab-header>Investment</app-tab-header>
          <app-tab-body>
            <div class="padding--2x"><app-drag-and-drop ></app-drag-and-drop></div>
          </app-tab-body>
        </app-tab>
       
      </app-tabs>
</div>

<ng-container *ngIf="show$|async">
<app-modal size="large" (onChange)="closeModal()">
  <ng-container slot="body" *ngIf="loanDetails$|async as loanDetails">
    <div style="width: 100%;" id="loan-details">
      <div class="d-flex d-flex_horizontal--space-between d-flex_vertical--center" style="width: 100%;">
        <div>
          <small>Loan Application</small>
          <h2>{{loanDetails.code}}</h2>
        </div>
        <div class="d-flex">
          <app-button size="small"  [class]="'widget_button--fill widget_button--small'"><ng-container slot="button">Repayment</ng-container></app-button>
          <div style="margin-left: 10px;"><app-button  size="small" color="secondary" [class]="'widget_button--fill widget_button--small'"><ng-container slot="button">Notify</ng-container></app-button></div>
        </div>
       
      </div>
      <div class="d-flex d-flex_vertical--center margin--2x">
        <div class="dot {{indicator$|async}}" style="margin-right: 10px;"></div>
        <div style="margin-right: 10px;"><p><b>Status</b></p></div>
        <div>
          <app-dropdown current="{{ctrl.value?ctrl.value:loanDetails.status}}" [control]="ctrl"  [fieldClass]="'no-margin--top'" [id]="'status'"   aria-placeholder="Change loan status">
            <app-option *ngFor="let t of loanStatuses; let i =index" [value]="t.label">{{t.label}}</app-option>
        </app-dropdown>
        </div>
      </div>

      <div *ngFor="let detail of loanDetails.details">
        <div class="title"><h3>{{detail.key}}</h3></div>
        <div class="margin--3x">
          <div class="detail-card" *ngFor="let d of detail.data">
            <small>{{d.key}}</small>
            <p><b>{{d.value}}</b></p>
          </div>
         
        </div>
        
      </div>
    </div>
  </ng-container>
</app-modal>

<ng-container *ngIf="(showConfirm$|async)==true">
  <app-modal [show]="showConfirm$|async" (onChange)="closeConfirmModal()">
    <app-modal-header slot="header">
      <h3>Change Notice</h3>
    </app-modal-header>
    <app-modal-body  slot="body">
      <p>Are you sure you want to change the status of this loan to <b>{{ctrl.value}}</b>?</p>
      <div class="d-flex d-flex_horizontal--space-between">
        <app-button [class]="'no-margin--bottom widget_button--stroke widget_button--small'" (onClick)="closeConfirmModal()" ><ng-container slot="button">Cancel</ng-container></app-button>
      <app-button [class]="'no-margin--bottom widget_button--small'" (onClick)="confirm()" ><ng-container slot="button">Continue</ng-container></app-button>
        
      </div>
    </app-modal-body>
  </app-modal>
  
  </ng-container>
</ng-container>
